{{view Balanced.PageNavigationView title="Settings"}}

{{#view Balanced.BodyPanelView}}
	{{#view Balanced.ApiModelPanelView model=model}}
		{{view Balanced.SettingsMarketplaceTitledKeyValuesSectionView model=model}}
		{{view Balanced.SettingsOwnerTitledKeyValuesSectionView model=model}}
	{{/view}}

	{{#view Balanced.MainPanelView}}
		<h3>Payment methods</h3>
		<div class="results">
			{{view Balanced.EmbeddedFundingInstrumentsResultsView loader=fundingInstrumentsResultsLoader}}
		</div>

		<h3>API keys</h3>
		<span class="warn">(All keys have admin access to the dashboard)</span>
		{{api-key-create-modal keys=userMarketplace.fullKeys marketplaceSecret=marketplaceSecret userMarketplace=userMarketplace name=name production=production user=user}}

		<div class="results">
			{{api-keys-table keys=userMarketplace.fullKeys marketplaceSecret=marketplaceSecret userMarketplace=userMarketplace}}
		</div>

		{{#unless auth.isGuest}}
			<section class="users-info">
				<h3>Users
					{{user-create-modal marketplaceBinding="model" userMarketplace=userMarketplace}}
				</h3>
				{{users-table users=userMarketplace.users}}
			</section>
		{{/unless}}

		<section class="webhook-info">
			<h3>Webhooks
				{{add-callback-modal marketplaceBinding="model"}}
			</h3>
			<table class="items non-interactive webhooks">
				<thead>
					<th class="span3"><span>Version</span></th>
					<th class="span11"><span>Method &amp; URI</span></th>
					<th><span></span></th>
				</thead>
				<tbody>
					{{#each callback in callbacks}}
						<tr>
							<td class="callback-revision">
								<span>Revision {{callback.revision}}</span>
							</td>
							<td class="url">
								<span class="callback-method"><span class="uppercase">{{callback.method}}</span> {{callback.url}}</span>
							</td>
							<td>
								<a href="#" {{action "openDeleteCallbackModal" callback}}><i class="icon-table-x"></i></a>
							</td>
						</tr>
					{{else}}
						<tr>
							<td colspan="3" class="no-results">
								No results
							</td>
						</tr>
					{{/each}}
				</tbody>
			</table>
		</section>
	{{/view}}
{{/view}}

{{view Balanced.EditMarketplaceInfoModalView contentBinding="model" viewName="editMarketplaceInfoModal"}}
{{view Balanced.DeleteBankAccountModalView}}
{{view Balanced.DeleteCardModalView}}
{{view Balanced.DeleteCallbackModalView}}
